name: Trigger Jenkins on Push

on:
  push:
    branches:
      - muhamed_joulani_final_project

jobs:
  trigger_jenkins_job:
    runs-on: ubuntu-latest

    steps:
      - name: Install Java (required for Jenkins CLI)
        run: |
          sudo apt-get update
          sudo apt-get install -y default-jre

      - name: Download Jenkins CLI JAR
        run: |
          curl -O http://100.27.108.130:8080/jnlpJars/jenkins-cli.jar

      - name: Trigger Jenkins job using Jenkins CLI
        env:
          JENKINS_URL: http://100.27.108.130:8080
          JENKINS_USER: mjoulani
          JENKINS_PASSWORD: 1234
          #JENKINS_PASSWORD: ${{ secrets.JENKINS_PASSWORD }}  # Make sure to store Jenkins password securely in GitHub Secrets
          JOB_NAME: kube_jen
        run: |
          java -jar jenkins-cli.jar -s "$JENKINS_URL" -auth "$JENKINS_USER:$JENKINS_PASSWORD" build "$JOB_NAME"
